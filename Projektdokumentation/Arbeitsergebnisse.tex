\chapter{Arbeitsergebnisse}
\begin{itemize}
	\item Ergebnisse, welche für den weiteren Verlauf relevant sind (z.B. zu realisierende Szenarien)
	\item weiterverfolgte Szenarien
\end{itemize}

\section{Szenarien}

\subsection{Effizienz und Komfort - Erkennung der Anzahl der Personen in einem Raum}
\emph{(von Philip Laube)}
\subsubsection{Ablauf}
Person A geht zusammen mit Person B vom Flur in das Wohnzimmer, während Person C in die Küche geht.
Die Lichter werden im Flur deaktiviert, im Wohnzimmer und in der Küche aktiviert.
Person D betritt die Wohnung und wird von den Personen A und B in der Tür zum Wohnzimmer begrüßt. Zusammen gehen sie ins Wohnzimmer.
Dabei werden zunächst die Lichter im Flur erneut aktiviert und nach der Begrüßung wieder deaktiviert.
Nach einiger Zeit ruft Person D zum Essen und es verlassen Personen A, B und C das Wohnzimmer und gehen in die Küche.
Sobald die letzte Person das Wohnzimmer verlassen hat werden die Lichter im Wohnzimmer deaktiviert.

\subsubsection{Erforderliche Komponenten}
\begin{itemize}
	\item ZWay Steuereinheit
	\item 2 x Bewegungsmelder / Fibaro 6-in-1 Sensor pro Tür
	\item Modul zur Lichtersteuerung
\end{itemize}

\subsubsection{zur Diskussion}
Unbekannt ob Begrüßungssituation ausreichend abgegrenzt werden kann, ohne Fehler hervorzubringen.
Tür könnte zusätzlich mit Türsensor ausgestattet werden um ein Durchgehen zu bestätigen bzw. vorbeigehende Personen bei geschlossener Tür zu ignorieren.

\subsubsection{Modellierung Erkennung der Personenanzahl}
Das Modell (\prettyref{fig:szenarienPersonenerkennung}) zeigt den Ablauf für den Personenzähler bei einer Erkennung eines Personenübergangs mit unterschiedlichen Mitteln. Sofern ein Übergang erkannt wurde, werden die Personenzähler angepasst. Daraufhin können andere Module eine Aktion, abhängig von der nun neuen Personenanzahl pro Raum, starten.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.7]{img/Szenarien/ErkennungAnzahlPersonen.pdf}
	\caption{Erkennung der Personenanzahl}
	\label{fig:szenarienPersonenerkennung}
\end{figure}

\subsubsection{Modellierung Personenerkennung an der Tür}
Das Modell (\prettyref{fig:szenarienPersonenerkennungTür}) zeigt den Ablauf für die beiden Bewegungssensoren an einem Türdurchgang. Dabei wird nach einer Aktivierung eines Sensors auf einer Seite der Tür auf den zweiten Sensor auf der anderen Seite der Tür eine gewisse Zeit gewartet. Sofern beide Sensoren innerhalb dieses gewissen Zeitraums aktiviert wurden ist ein Durchgang erkannt worden und die jeweiligen Personenzähler der anliegenden Räume werden angepasst.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.7]{img/Szenarien/PersonenerkennungAnTuer.pdf}
	\caption{Personenerkennung an der Tür}
	\label{fig:szenarienPersonenerkennungTür}
\end{figure}

\subsection{Haus bei verschließen der Haus-/ Wohnungstür in "`Standby"' versetzen}
\label{subsec:szenarioStandby}
\emph{(von Simon Schwabe)}
\subsubsection{Ablauf}
Um den Komfort in ihrem Smart Home zu steigern, möchte Anne möglichst wenig Aufwand zur Steuerung des Lichts betreiben. Dazu möchte sie bei Verlassen der Wohnung nicht alle angeschalteten Lampen manuell ausschalten und überprüfen, ob Gefahrenquellen vom Stromnetz getrennt sind.

Ein intelligentes, vernetztes Türschloss überträgt dazu beim Abschließen der Wohnung ein entsprechendes Signal an die zentrale Steuereinheit. Diese Steuereinheit interpretiert das Signal und schaltet alle Lampen aus. Außerdem werden vorher konfigurierte Steckdosen deaktiviert, um das Brandrisiko zu minimieren. Damit wird die Wohnung in einen "`Standby-Modus"' versetzt. Auch in diesem Fall möchte Anne nicht alle Geräte vom Stromnetz trennen, ihr Laptop soll weiterhin mit Strom versorgt und der Akku geladen werden.

Befindet sich Tom noch in der Wohnung, wenn sie abschließt, soll er nicht durch die Steuerung gestört werden. Das heißt in diesem Fall wird die automatische Abschaltung nicht durchgeführt. Dazu ist es notwendig, dass verschiedene Sensoren des Systems zuverlässig erkennen, ob Personen anwesend sind. Die automatische Steuerung wird erst aktiv, wenn der letzte Bewohner die Wohnung verlässt und abschließt.

Der Standby-Modus wird mit Aufschließen der Wohnungstür deaktiviert. Es erscheint allerdings nicht sinnvoll, den Zustand zum Zeitpunkt des Verlassens wiederherzustellen, da die Anforderungen an Beleuchtung usw. beim Ankommen grundlegend andere als bei Verlassen der Wohnung sein können. Diese sind abhängig von der Tageszeit.

\subsubsection{zur Diskussion}
\begin{itemize}
	\item welche Komponenten sind von Abschaltung betroffen (z.B. Lampen, Steckdosen von Wasserkocher, Kaffeemaschine, ...)
	\item welche Komponenten sind ausgeschlossen (z.B. Kühl- und Gefrierschränke, Waschmaschinen, ...)
\end{itemize}

\subsubsection{erforderliche Komponenten}
\begin{itemize}
	\item Steuereinheit
	\item vernetztes Türschloss
	\item Sensoren zu Personenerkennung: z.B. Bewegungsmelder, Infrarot
	\item schaltbare Steckdosen, evtl. mit Verbrauchserkennung
	\item schaltbare Lampen
\end{itemize}


\subsubsection{Modellierung aus Nutzersicht}
Das Modell (\prettyref{fig:szenarienStandbyNutzersicht}) verdeutlicht die im Szenario beschriebene Interaktion des Nutzers mit dem System. Ziel des Szenarios ist es, dem Nutzer möglichst hohen Komfort zu bieten. Aus diesem Grund sind die Interaktionsmöglichkeiten des Nutzers mit dem System bewusst auf das Notwendigste beschränkt. Das Szenario wird indirekt durch den Nutzer initiiert, indem er die Wohnungstür abschließt. Auf diese Weise entsteht für die Nutzer kein Mehraufwand und keine direkte Interaktion mit dem System.

Mit dem Abschließen der Tür ist die Erwartung des Nutzers verbunden, dass die Wohnung in einen Standby-Modus tritt. Sollte dies aufgrund anwesender Personen nicht möglich sein, sollte der Nutzer über ein geeignetes Mittel darüber informiert werden. Dazu kann beispielsweise eine Benachrichtigung auf das Mobiltelefon des Nutzers gesendet werden.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.7]{img/Szenarien/WohnungSchliessenNutzersicht.pdf}
	\caption{Abläufe bei Verschließen der Wohnung aus Nutzersicht}
	\label{fig:szenarienStandbyNutzersicht}
\end{figure}

\subsubsection{Modellierung aus Systemsicht}
Die technische Modellierung (\prettyref{fig:szenarienStandby}) gestaltet sich etwas umfangreicher. Gestartet wird der Ablauf durch das Schließen des konfigurierten Schlosses. Alternativ kann auch ein Schalter an der Wohnungstür betätigt werden. Das System überprüft daraufhin, ob noch Personen in der Wohnung anwesend sind. Ist das der Fall, wird die Aktion abgebrochen und anwesende Personen werden nicht in ihren Aktivitäten beeinträchtigt. In diesem Fall kann der Nutzer, welcher die Wohnung verlassen hat, informiert werden.

Wird zum Zeitpunkt des Abschließens keine anwesende Person erkannt, wird ein Timer gestartet. So lange dieser Timer aktiv ist, wird in regelmäßigen Abständen überprüft, ob Personen, bzw. Bewegungen in der Wohnung erkannt werden. Dieses Vorgehen soll die Gefahr reduzieren, dass anwesende Personen nicht wahrgenommen werden. Wird während der Laufzeit des Timers eine Person erkannt, wird die Aktion wie oben beschrieben abgebrochen.

Trotz dieses Vorgehens ist nicht auszuschließen, dass Personen in der Wohnung nicht korrekt erkannt werden. Für diesen Fall kann ein zusätzlicher Feedback-Modus implementiert werden, in dem die anwesenden, nicht erkannten Personen über die anstehende Aktion informiert werden. Erfolgt kein Feedback, werden konfigurierte Geräte in den Standby-Modus versetzt.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Szenarien/WohnungSchliessen.pdf}
	\caption{Abläufe bei Verschließen der Wohnung aus Systemsicht}
	\label{fig:szenarienStandby}
\end{figure}

\subsection{Gefahrenquellen abstellen (Fibaro, CO$_2$)}
\emph{(von Martin Petzold)}
\subsubsection{Auslöser (opt.)}
\begin{itemize}
	\item Erkennung Erwachsene Person (Fibaro, CO$_2$)
\end{itemize}

\subsubsection{Vorbedingung}
\begin{itemize}
	\item Zuverlässige Erkennung ob Personen den Raum betreten oder Verlassen wurde bereits realisiert (Szenario Herr Laube)
\end{itemize}

\subsubsection{Ablauf}
Das System befindet sich im Standby, d.h. alle Gefahrenquellen im Raum sind ausgeschaltet. Person X (ein Kind) betritt den Raum. Das Betreten des Raumes wir vom System erkannt, nun wird ein Vorgang gestartet der die Person als Kind oder Erwachsenen zu identifizieren. Person X wir dabei als Kind identifiziert somit bleiben die Gefahrenquellen abgeschaltet. 
Nun betritt Person Y (ein Erwachsener) den Raum, dessen Betreten wird ebenfalls vom System erkannt. Der Erkennungsvorgang wird ein zweites mal Gestartet. das System erkennt das es sich bei einer der Beiden Personen um eine Erwachsene Person handeln muss und Schaltet die Gefahrenquellen frei so das diese benutzt werden können.
Nach einer Weile verlässt Person Y den Raum, das System Stellt fest das sich kein erwachsener mehr im Raum befindet und schaltet nach einer gewissen Zeit den Standby Modus wieder her.

\subsubsection{Alternativer Ablauf}
Nur Person Y(ein Erwachsener)  betritt den Raum, System erkennt den Eintritt. Er wird beim Identifizierungsvorgang als Erwachsener erkannt und damit werden die Gefahrenquellen freigeschaltet.
Nach einer Weile verlässt Person Y den Raum, das System Stellt fest das sich kein erwachsener mehr im Raum befindet und schaltet nach einer gewissen Zeit den Standby Modus wieder her.

\subsubsection{erforderliche Komponenten}
\begin{itemize}
	\item Fibaro 6 in 1 Sensor
	\item CO$_2$ Sensor
	\item Z-Way-Server/Steuereinheit
	\item 2 Bewegungsmelder zur Erkennung von Eintritt in den Raum
	\item Schaltbare Gefahrenquelle (zur Demonstration reicht auch eine Schaltbare Signalquelle)
\end{itemize}

\subsubsection{Nachbedingung (opt.)}
\begin{itemize}
	\item Das System kann auch eine Regelung beinhalten das der Standby Modus irgendwann automatisch und nicht nach verlassen des Raumes Zeitgesteuert wieder hergestellt wird.
\end{itemize}

\subsubsection{zur Diskussion}
\begin{itemize}
	\item Abgleich mit dem Szenario zur Erkennung  Person hat den Raum betreten/verlassen
	\item sind die Sensoren Präzise genug um den Unterschied Kind Erwachsener zu erfassen, oder kann wie im Werbevideo nur Mensch und Haustier unterschieden werden
	\item soll die Wieder Standby Schaltung des Systems Teil des Szenarios sein
	\item Einordnung in Umsetzbar/Nicht Umsetzbar
\end{itemize}

\subsubsection{ähnliche Szenarien}
\begin{itemize}
	\item Verknüpfung mit zur Erkennung  Person hat den Raum betreten/verlassen
	\item Verknüpfung mit Haus bei verschließen der Haus- Wohnungstür in "`Standby"' versetzen als Regelung zur Herstellung des Standby Zustandes
\end{itemize}

\subsubsection{Modellierung Identifizierung Erwachsener}
\emph(//TODO BITTE NOCH BESCHREIBUNGSTEXT EINFÜGEN (siehe Modell))
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Szenarien/IdentifizierungErwachsene.pdf}
	\caption{Identifizierung Erwachsener}
	\label{fig:szenarienIdentifizierungErwachsene}
\end{figure}

\subsubsection{Modellierung Gefahrenquellen abstellen}
\emph(//TODO BITTE NOCH BESCHREIBUNGSTEXT EINFÜGEN (siehe Modell))
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Szenarien/GefahrenquellenAbstellen.pdf}
	\caption{Gefahrenquellen abstellen}
	\label{fig:szenarienGefahrenquellenAbstellen}
\end{figure}


\section{Modulkonzeption}
TODO: allgemeine Beschreibung aller Module, deren Zusammenwirken (Grafik).

\subsection{LockDoorModule}
\emph{(von Simon Schwabe)}

\subsubsection{Allgemein}
Das LockDoorModule ist der Vermittler für weitere Module im Zusammenhang mit dem Verlassen der Wohnung. Wenn die Wohnung verlassen und abgeschlossen wird, ist die Wahrscheinlichkeit hoch, dass keine weiteren Personen anwesend sind. Allerdings kann die Wohnung auch irrtümlich abgeschlossen werden und es sind noch weitere Personen anwesend. Um solchen Fehlinterpretationen entgegenzuwirken überprüft das LockDoorModule immer, ob wirklich keine Personen erkannt werden und die Wohnung leer steht. Diese Information ist für weitere Module, insbesondere das AlarmModule, relevant und wird über den Event Bus mitgeteilt.

\subsubsection{Funktionsweise}
Die genaue Funktionsweise des Moduls wurde im Wesentlichen schon im Abschnitt Szenarien (siehe \prettyref{subsec:szenarioStandby}) beschrieben und modelliert. Das Modell „Abläufe bei Verschließen der Wohnung aus Systemsicht“ (\prettyref{fig:szenarienStandby}) beschreibt das Vorgehen. Die Aktivität „Standby aktivieren“ kann um das Werfen des entsprechenden Events erweitert werden.

Das Szenario enthält keine detaillierte Beschreibung für die Abschaltung des Standby-Modus, da nicht sinnvoll. Für das Modul LockDoor ist es allerdings erforderlich auf die Ankunft von Personen zu reagieren, z.B. um das Alarm-Modul zu benachrichtigen und die Alarmanlage abzuschalten. %Die Anzahl der durchzuführenden Aktionen ist überschaubar und wird im Modell dargestellt (\prettyref{fig:modulkonzeptionLockDoorSequence}).
Dazu wird bei Ankunft der entsprechende Schalter betätigt, bzw. das Schloss geschlossen. Anschließend wird das Event "`LockDoorModule\_unlocked"' geworfen. An dieser Stelle ist keine weitere Logik erforderlich.

%TODO Grafik an geeigneter Stelle einbinden und beschreiben.
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Modulkonzeption/LockDoorSequence.pdf}
	\caption{Sequenzdiagramm - LockDoorModule}
	\label{fig:modulkonzeptionLockDoorSequence}
\end{figure}

\subsubsection{Konfiguration}
Bei der Konfiguration des LockDoor muss das Wohnungstürschloss angegeben werden, alternativ kann dafür ein Schalter benutzt werden, der im inneren der Wohnung vor dem Verlassen betätigt wird. 
\begin{itemize}
	\item Schloss/Schalter
	\begin{itemize}
		\item Typ: BinarySwitch
		\item erforderlich: ja
	\end{itemize}
\end{itemize}

\subsubsection{Schnittstellen}
Die Schnittstellen, welche dieses Modul nutzt und bereitstellt, sind von großer Bedeutung. Das Modul an sich implementiert geringe Funktionalität, es ist eine Brücke zwischen den Modulen zur Raumüberwachung auf der einen Seite, und den Modulen für Aktionen bei Verlassen der Wohnung.

LockDoor bietet über den Event Bus eine Schnittstelle zu anderen Modulen. Diese werden benachrichtigt, sobald davon ausgegangen wird, dass keine Person mehr anwesend ist (LockDoorModule\_locked). Die Freischaltung geschieht über ein weiteres Event (LockDoorModule\_unlocked).

Das Modul wird als Singleton angelegt, da für jede Wohnung nur ein Modul zur Überwachung der Wohnungstür erforderlich ist. Das hat zur Folge, dass Events keine Virtual Device Id tragen. Damit ist es für Empfänger einfacher, auf entsprechende Events zu reagieren.

Für die Überprüfung der Personenanzahl wird die Schnittstelle des Moduls PersonCounter genutzt. Dazu wird für jeden Raum die Anzahl der Personen überprüft.


%\begin{tabularx}{\textwidth}{ X X X }
%	\hline \multicolumn{3}{c}{\textbf{Event Bus - Senden}}  \\ 
%	\hline Event Name 					& Parameter 	& Beschreibung \\ 
%	\hline door\_lock\_module\_locked	& - 			& Tür verschlossen, keine Person anwesend \\ 
%	\hline door\_lock\_module\_unlocked & - 			& Tür geöffnet \\ 
%	\hline 
%\end{tabularx}

\begin{table}
\begin{tabularx}{\textwidth}{
		 >{\hsize=1.25\hsize}X % 40% of 3\hsize 
		>{\hsize=0.5\hsize\centering}X % 30% of 3\hsize
		>{\hsize=1.25\hsize}X % 40% of 3\hsize
		% sum=3.0\hsize for 3 columns
	}	
	\hline
	\textbf{Event Name}					& \textbf{Parameter}	& \textbf{Beschreibung} \\
	\hline LockDoorModule\_locked		& - 					& Tür verschlossen, keine Person anwesend \\ 
	\hline LockDoorModule\_unlocked		& - 			 		& Tür geöffnet \\ 
	\hline
\end{tabularx}
\caption{Event Bus - Senden}
\end{table}


%\begin{longtable}{R{5cm} L{7cm}}
%	\toprule
%	\textit{Option} & \textit{Konfiguration} \\
%	\midrule
%	Feedbackart & Frage \\ [0.25cm]
%	Feedback von & Nutzer mit E-Mail-Adresse für Rückmeldungen \\[0.25cm]
%	Ausführender & Mitarbeiter der Abteilung \glqq Qualitätssicherung\grqq \\[0.25cm]
%	Kategorie & Einordnung in die Kategorie \glqq Mobiles Menü-Bestellsystem\grqq \\[0.25cm]
%	Erklärung & Frage mit Zusatzinformationen zur Menükomponente auf die sich die Frage bezieht \\[0.25cm]
%	\bottomrule	
%	\caption{Beispielkonfiguration des CRM Systems}
%\end{longtable}

\subsubsection{Abhängigkeiten}
\begin{itemize}
	\item PersonCounterModule
	\item TurnOffTimerModule
\end{itemize}
Die entsprechenden Module sind noch nicht beschrieben und genutzte Schnittstellen müssen noch analysiert und auf Nutzungsmöglichkeiten überprüft werden.

Das PersonCounterModule wird zur Überprüfung der Personenanzahl je Raum genutzt. Dazu werden Aufrufe über die ZAutomation-API an das Modul gesendet.

Der TurnOffTimer stellt die eine Schnittstelle zum FeedbackModule her. Durch die zusätzliche Abstraktionsschicht des TurnOffTimers arbeitet das LockDoorModule nicht direkt gegen das FeedbackModul, sondern startet lediglich den Timer. Dieser übernimmt die Kommunikation mit dem FeedbackModule.


\subsubsection{Interne Speicher}
\begin{itemize}
	\item konfiguriertes Türschloss
\end{itemize}

\subsection{PersonCounterModule}
\emph{(von Philip Laube)}
\subsubsection{Allgemein}
Das PersonCounterModule übernimmt die Aufgabe, die Anzahl der Personen im jeweiligen Raum zu speichern. Jede Möglichkeit einer Erkennung ob eine Person den Raum betreten oder verlassen hat kann über dieses Modul kommuniziert werden um es anderen Modulen zur Verfügung zu stellen. Dies macht dieses Modul zu einem zentralen Bestandteil.

Ein PersonCounterModule enthält zusätzlich die Information für welchen Raum es bestimmt ist, somit kann es beliebig oft wiederverwendet werden.

Der jeweilige Personenzähler pro Raum wird durch das Modul die dies benötigen instanziiert sofern noch keine Personenzähler für die jeweiligen Räume vorhanden sind.

\subsubsection{Funktionsweise}
Dieses Modul wird nur indirekt benutzt. Es dient als Datenhaltung für wichtige, für andere Module nötige Informationen der Personenanzahl (\prettyref{fig:szenarienPersonenerkennung}). (//TODO: Bildverweis wie gedacht?)

Die Instanziierung des Moduls findet entweder zentral über ein Modul statt oder wird als Funktion bereitgestellt. Es kann dann entweder automatisch oder pro Modul über eine Funktion instanziiert und benutzt werden.

\subsubsection{Konfiguration}
\begin{itemize}
	\item Zähler
	\begin{itemize}
		\item Typ: Metrik
		\item Erforderlich: ja
	\end{itemize}
	\item Raum
	\begin{itemize}
		\item Typ: Text
		\item Erforderlich: ja
	\end{itemize}
\end{itemize}

\subsubsection{Schnittstellen}

\begin{table}[H]
	\begin{tabularx}{\textwidth}{
			>{\hsize=1.25\hsize}X % 40% of 3\hsize 
			>{\hsize=0.5\hsize\centering}X % 30% of 3\hsize
			>{\hsize=1.25\hsize}X % 40% of 3\hsize
			% sum=3.0\hsize for 3 columns
		}
		\hline
		\textbf{URL}						& \textbf{Parameter}	& \textbf{Beschreibung} \\
		\hline /command/person\_entered		& - 					& Erhöht den Zähler um 1. \\ 
		\hline /command/person\_left		& - 			 		& Mindert den Zähler um 1. \\
		\hline /command/persons				& - 					& Liefert die aktuelle Anzahl an Personen des Raums. \\
		\hline
	\end{tabularx}
	\caption{PersonCounterModule: Schnittstelle ZAutomation}
\end{table}

\begin{table}[H]
	\begin{tabularx}{\textwidth}{
			>{\hsize=2.0\hsize}X % 66.66% of 3\hsize 
			>{\hsize=0.5\hsize\centering}X % 16.66% of 3\hsize
			>{\hsize=0.5\hsize\centering\arraybackslash}X % 16.66% of 3\hsize
			% sum=3.0\hsize for 3 columns
		}
		\hline
		\textbf{Event Name}						& \textbf{Parameter}	& \textbf{Beschreibung} \\
		\hline [DeviceId]:PersonCounterModule\_[RaumId]\_person\_entered	& - 					& - \\ 
		\hline [DeviceId]:PersonCounterModule\_[RaumId]\_person\_left		& - 			 		& - \\
		\hline
	\end{tabularx}
	\caption{PersonCounterModule: Schnittstelle Event Bus}
\end{table}

\subsubsection{Abhängigkeiten}
\begin{itemize}
	\item Keine da dieses Modul Grundfunktionalitäten bereitstellt.
\end{itemize}

\subsubsection{Interne Speicher}
\begin{itemize}
	\item Raum ID
	\item Anzahl der Personen im Raum
\end{itemize}


\subsection{RoomAccessModule}
\emph{(von Philip Laube)}

\subsubsection{Allgemein}
Das RoomAccessModule übernimmt die Aufgabe, Personen zu erkennen die einen Raum verlassen oder betreten haben. Entweder sofortig oder zeitversetzt, je nach Art der zugrundeliegende Module.

Dieses Modul stellt grundlegende Unterstützung zunächst für Bewegungssensoren, später eventuell auch erweiterte Logik für andere Sensoren zur Personenerkennung bzw. Raumwechsel.

Ein RoomAccessModule enthält zusätzlich die Information für welche Räume es bestimmt ist, somit kann es beliebig oft wiederverwendet werden.

\subsubsection{Funktionsweise}
Diese Realisierung entspricht der geplanten Realisierung des Szenarios zu Beginn des Projekts. Exakt diese Logik wird zunächst durch dieses Modul implementiert (\prettyref{fig:szenarienPersonenerkennungTür}). //TODO: Bildverweis wie gedacht?

Es wird der zugehörige Personenzähler der jeweiligen Räume angesprochen und die Anzahl jeweils korrigiert. Weitere Logik anderer Module kann durch ein Event erfolgen. Jedwede Logik die direkt mit der Personenanzahl in Verbindung steht muss den Personenzähler (PersonCounterModule) ansprechen.

\subsubsection{Konfiguration}
\begin{itemize}
	\item Sensor Eins
	\begin{itemize}
		\item Typ: Bewegungssensor
		\item Erforderlich: ja
	\end{itemize}
	
	\item Raum Eins
	\begin{itemize}
		\item Typ: Raum
		\item Erforderlich: ja
	\end{itemize}

	\item Sensor Zwei
	\begin{itemize}
		\item Typ: Bewegungssensor
		\item Erforderlich: ja
	\end{itemize}
	
	\item Raum Zwei
	\begin{itemize}
		\item Typ: Raum
		\item Erforderlich: ja
	\end{itemize}

\end{itemize}

\subsubsection{Schnittstellen}
\begin{table}[H]
	\begin{tabularx}{\textwidth}{
			>{\hsize=1.25\hsize}X 
			>{\hsize=0.75\hsize}X
			% sum=2.0\hsize for 2 columns
		}
		\hline
		\textbf{Event Name}						& \textbf{Beschreibung} \\
		\hline [DeviceId]:RoomAccessModule\_[verlassenderRaumId]\_[betretenerRaumId]\_transition\_detected	& Wenn ein Übergang einer Person von einem Raum in den nächsten 	Raum erfolgt ist wird dieses Event ausgelöst \\ 
		\hline 
	\end{tabularx}
	\caption{RoomAccessModule: Schnittstellen Event Bus}
\end{table}

\subsubsection{Abhängigkeiten}
\begin{itemize}
	\item Daten des PersonCounterModule zum Zählen der Personen in einem Raum
\end{itemize}

\subsubsection{Interne Speicher}
\begin{itemize}
	\item Zwei Bewegungssensoren
	\item Raum Zuordnung der beiden Sensoren
	\item PersonenCounterModule der Raumzuordnungen
\end{itemize}

\subsection{StandbyModule}
\emph{(von Zarina Muratbekovna Omurova)}
\subsubsection{Allgemein}
Das StandbyModule übernimmt die Aufgabe, das Haus in einen Standby-Modus zu versetzen.

Im Fall, dass niemand zu Hause ist und das Event "`LockDoor\_locked"' vom LockDoorModule eingegangen ist, werden ausgewählte Geräte, wie Lampen, Heizung oder Elektrogeräte im Haus in einen definierten Zustand geschaltet. Manche Geräte, z.B. Steckdosen, sollen ausgeschaltet werden, wenn die Wohnung in den Standby-Modus geht. Andere Geräte, z.B. Orientierungsleuchten oder Alarmanlagen sollen angeschaltet werden. Diese Geräte und die entsprechenden Aktionen werden beim Anlegen des StandbyModules konfiguriert.

Bei dem Event "`LockDoor\_unlocked"', werden keine Aktionen durchgeführt, dies bewirkt, dass der interne Zustand des StandbyModules auf "`stopped"' geändert wird.

Wenn die Tür geöffnet wird, wird automatisch der Standby-Modus ausgeschaltet und ein entsprechendes Event an andere Module gesendet.

\subsubsection{Funktionsweise}

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.7]{img/Modulkonzeption/StandbyStateMachine.pdf}
	\caption{Zustandsdiagramm – StandbyModule}
	\label{fig:standbyStateMachine}
\end{figure}


Dieses Modell veranschaulicht die verschiedenen internen Zustände des StandbyModules und deren Zustandsübergänge. Wenn es im inaktiven Zustand ist, wird das Modul durch einen Startkommando in einen aktiven Zustand übergehen und im aktivem Zustand kann das Modul in einen inaktiven Zustand wechseln.

\subsubsection{Konfiguration}
\begin{itemize}
	\item Geräte, welche bei Aktivierung des Standby geschaltet werden
	\begin{itemize}
		\item 	Typ: Liste [Switch Binary, Switch Multilevel]
		\item Aktion: on/off 
		\item Erforderlich: ja
	\end{itemize}
	\item Geräte, welche bei Dektivierung des Standby geschaltet werden
	\begin{itemize}
		\item 	Typ: Liste [Switch Binary, Switch Multilevel]
		\item Aktion: on/off 
		\item Erforderlich: ja
	\end{itemize}
	\item Raum
	\begin{itemize}
		\item Typ: Text
		\item Erforderlich: ja
	\end{itemize}
\end{itemize}

\subsubsection{Schnittstellen}
\begin{table}[H]
	\begin{tabularx}{\textwidth}{
			>{\hsize=1.25\hsize}X % 40% of 3\hsize 
			>{\hsize=0.5\hsize\centering}X % 30% of 3\hsize
			>{\hsize=1.25\hsize}X % 40% of 3\hsize
			% sum=3.0\hsize for 3 columns
		}
		\hline
		\textbf{URL}						& \textbf{Parameter}	& \textbf{Beschreibung} \\
		\hline /command/started				& - 					& Starten des Standby-Modus. \\ 
		\hline /command/stopped				& - 			 		& Stoppen des Standby-Modus. \\
		\hline /command/state				& stopped started	& Liefert den aktuellen Zustand des Moduls. \\
		\hline
	\end{tabularx}
	\caption{StandbyModule: Schnittstelle ZAutomation}
\end{table}

\begin{table}[H]
	\begin{tabularx}{\textwidth}{
			>{\hsize=1.25\hsize}X % 66.66% of 3\hsize 
			>{\hsize=0.5\hsize\centering}X % 16.66% of 3\hsize
			>{\hsize=1.25\hsize\centering\arraybackslash}X % 16.66% of 3\hsize
			% sum=3.0\hsize for 3 columns
		}
		\hline
		\textbf{Event Name}								& \textbf{Parameter}	& \textbf{Beschreibung} \\
		\hline [DeviceId]:StandbyModule\_[RaumId]\_started	& - 				& Standby-Modus wurde gestartet \\ 
		\hline [DeviceId]:StandbyModule\_[RaumId]\_stopped	& - 				& Standby-Modus wurde beendet \\
		\hline
	\end{tabularx}
	\caption{StandbyModule: Schnittstelle Event Bus}
\end{table}

\subsubsection{Abhängigkeiten}
\begin{itemize}
	\item Module Events (LockDoor)
\end{itemize}

\subsubsection{Interne Speicher}
\begin{itemize}
	\item Raum ID
	\item Zustand des Raums (im Standby: stopped/started)
	\item Switches/Dimmers
\end{itemize}

\subsection{InHomeFeedbackModule}
\emph{(von Patrick Hecker)}
\subsubsection{Allgemein}
Das Feedbackmodul übernimmt die Aufgabe, Personen im Haus über eingehende Aktionen zu informieren. Neben den eingehenden Aktionen (von Personen außerhalb des Hauses) kann auch auf Aktionen, die vom System automatisch gestartet wurden, hingewiesen werden (Timer, Grenzwert eines Sensors überschritten, ...). Die Personen im Haus haben dadurch die Möglichkeit auf Aktionen zu reagieren, indem sie sie abbrechen bzw. verzögern können. Der konkrete Feedbackmechanismus kann individuell konfiguriert werden und gliedert sich in folgende fünf Kategorien (detaillierter in Abschnitt Konfiguration).

\begin{itemize}
	\item visuelles Feedback (bspw. Lampen, LED’s an Schalter, ...),
	\item akustisches Feedback (bspw. Sirene, ...)
	\item Nachricht (bspw. E-Mail, Push-Nachricht, ...)
	\item Aufruf spezieller Module (bspw. Philips Hue, Bose, ...)
	\item HTTP
	\item JavaScript
\end{itemize}
Ein Feedbackmodul enthält zusätzlich die Information für welchen Raum es bestimmt ist, somit kann es beliebig oft wiederverwendet werden.

\subsubsection{Funktionsweise}

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.7]{img/Modulkonzeption/FeedbackStateMachine.pdf}
	\caption{Zustandsdiagramm – InHomeFeedbackModule}
	\label{fig:feedbackStateMachine}
\end{figure}

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Modulkonzeption/FeedbackSequence.pdf}
	\caption{Sequenzdiagramm – InHomeFeedbackModule – Beispiel 1}
	\label{fig:feedbackSequence}
\end{figure}

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Modulkonzeption/FeedbackSequenceUser.pdf}
	\caption{Sequenzdiagramm – InHomeFeedbackModule – Beispiel 2}
	\label{fig:feedbackSequenceUser}
\end{figure}


\subsubsection{Konfiguration}

\begin{itemize}
	\item visuelles Feedback
	\begin{itemize}
		\item Typ: Liste [Binary Switch, Multilevel Switch]
		\item Aktion: on/off/on/off/on/... bzw. 0-99-0-99-0-...
		\item Erforderlich: nein
		\item Option:
		\begin{itemize}
			\item Frequenz
			\begin{itemize}
				\item Typ: Text
				\item Erforderlich: nein
				\item Default: 5 sek
			\end{itemize}
		\item spezieller Wert, bspw. RGB (RGB + Warmweiß + Kaltweiß)
		\end{itemize}
	\end{itemize}
	\item akustisches Feedback
	\begin{itemize}
		\item Typ: Liste [*] \textrightarrow{ }bspw. Aeon Labs Sirene \textrightarrow{ }Binary Switch
		\item Aktion: on/off
		\item Erforderlich: nein
	\end{itemize}
	\item Nachricht
	\begin{itemize}
		\item Vorbedingung: Auswahl von E-Mail bzw. Push-Nachricht
		\item Typ: Liste [Text] (E-Mail-Adresse bzw. URL)
		\item Aktion: HTTP-Request
		\item Erforderlich: nein
	\end{itemize}
	\item Aufruf spezieller Module
	\begin{itemize}
		\item Typ: Liste [Binary Switch, Multilevel Switch] \textrightarrow{ }Device Type der speziellen Module! (deviceType \textrightarrow{ }namespace\_deviceType)
		\item Aktion: on/off bzw. 0/99
		\item Erforderlich: nein
		\item Option:
		\begin{itemize}
			\item spezieller Wert, bspw. RGB (R + G + B + Warmweiß + Kaltweiß)
		\end{itemize}
	\end{itemize}
	\item HTTP
	\begin{itemize}
		\item Typ: Text
		\item Erforderlich: nein
	\end{itemize}
	\item JavaScript
	\begin{itemize}
		\item Typ: Text
		\item Erforderlich: nein
	\end{itemize}
	\item Raum
	\begin{itemize}
		\item Typ: Text
		\item Erforderlich: ja
	\end{itemize}
	\item Dauer (bis automisch deaktiviert)
	\begin{itemize}
		\item Typ: Text
		\item Erforderlich: nein
		\item Default: 30 sek
	\end{itemize}
	\item Verzögerungszeit
	\begin{itemize}
		\item Typ: Text
		\item Erforderlich: nein
		\item Default: 600 sek
	\end{itemize}
	\item Schalter (zum Abbrechen der eingehenden Aktion)
	\begin{itemize}
		\item Typ: Binary Switch
		\item Erforderlich nein
	\end{itemize}

\end{itemize}

\subsubsection{Schnittstellen}
%todo tabelle einfügen

\begin{table}[H]
	\begin{tabularx}{\textwidth}{
			>{\hsize=1.25\hsize}X % 40% of 3\hsize 
			>{\hsize=0.5\hsize\centering}X % 30% of 3\hsize
			>{\hsize=1.25\hsize}X % 40% of 3\hsize
			% sum=3.0\hsize for 3 columns
		}
		\hline
		\textbf{URL}						& \textbf{Parameter}	& \textbf{Beschreibung} \\
		\hline 
		/command/start				
				& duration (opt.) \newline endless=true (opt.) 	
						& Starten des Feedbackmodus (die Durchführung der Aktion wird nicht beeinflusst). Der Parameter "`endless=true"' startet den Feedback-Modus, ohne automatische Terminierung nach einer bestimmten Zeitspanne. \\ 
		\hline 
		/command/stop		
				& - 			 		
						& Stoppen des Feedbackmodus (die Durchführung der Aktion wird nicht beeinflusst). \\
		\hline 
		/command/state
				& - 				
						& Liefert den aktuellen Zustand des Moduls. \\
		\hline
		/command/cancel
				& -
						& Die Aktion abbrechen. \\
		\hline
		/command/defer
				& duration (opt.)
						& Die Aktion um eine bestimmte Zeit verschieben. \\
		\hline
	\end{tabularx}
	\caption{InHomeFeedbackModule: Schnittstelle ZAutomation}
\end{table}

\begin{table}[H]
	\begin{tabularx}{\textwidth}{
			>{\hsize=1.2\hsize}X 
			>{\hsize=0.8\hsize}X
			% sum=2.0\hsize for 2 columns
		}
		\hline
		\textbf{Event Name}						& \textbf{Beschreibung} \\
		\hline
		[deviceId]:InHomeFeedbackModule\_[roomId]\_started	
				& Feedbackmodus wurde gestartet \\
		\hline 
		[deviceId]:InHomeFeedbackModule\_[roomId]\_stopped\_normal
				& Feedbackmodus wurde nach der vorgegebenen Zeit beendet \\
		\hline
		[deviceId]:InHomeFeedbackModule\_[roomId]\_stopped\_manual
				& Feedbackmodus wurde  gestoppt \\
		\hline
		[deviceId]:InHomeFeedbackModule\_[roomId]\_canceled\_by\_user
				& Feedbackmodus wurde vom Nutzer abgebrochen (aufrufende Komponente sollte dieses Event abfangen und entsprechend reagieren) \\
		\hline
		[deviceId]:InHomeFeedbackModule\_[roomId]\_deferred
				& Aktion wurde um eine bestimmte Zeit aufgeschoben \\
		\hline
		[deviceId]:InHomeFeedbackModule\_[roomId]\_continued
				& - \\
		\hline
	\end{tabularx}
	\caption{InHomeFeedbackModule: Schnittstellen Event Bus}
\end{table}

\subsubsection{Abhängigkeiten}
\begin{itemize}
	\item Module, für Geräte von Drittanbietern (Philips Hue, Bose, ...)
\end{itemize}

\subsubsection{Interne Speicher}
\begin{itemize}
	\item Raum ID
	\item Zustand - aktiviert, deaktiviert, aufgeschoben
	\item Dauer - falls Modulkonfiguration für den Command überschrieben
	\item Verzögerungszeit - falls Modulkonfiguration für den Command überschrieben
	
\end{itemize}



\section{Sensorevaluation}
\begin{itemize}
	\item Ergebnisse der Sensorevaluation (je Sensor)
	\item Was funktioniert wie erwartet/was nicht?
	\item Welche technischen Probleme, lassen sich diese einschränken?
	\item Sind Probleme auf Hardware/Software zurückzuführen?
\end{itemize}

\subsection{Fibaro Multisensor}
\emph{(von Philip Laube)}

\subsubsection{Allgemein}
\begin{description}
	\item[Energieversorgung] CR123A battery, 3.6 VDC
	\item[Empfohlene Installationshöhe] 2,4m
	\item[Temperaturreichweite] -20°C bis 100°C
	\item[Temperaturgenauigkeit] 0,5°C bei 0°C bis 40°C
	\item[Lichtintensitätsreichweite] 0-32000 LUX
	\item[Reichweite des Z-Wave Funk] bis zu 50m außerhalb von Gebäuden, bis zu 30m innerhalb von Gebäuden
	\item[Reichweite des Bewegungssensors] 7 Meter
\end{description}

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.4]{img/Sensorevaluation/FibaroMulti.png}
	\caption{Fibaro Multisensor}
	\label{fig:sensorenFibaroMulti}
\end{figure}

Dieses Gerät ist vielseitig einsetzbar da eine Vielzahl von Sensoren zur Verfügung stehen. Die Bewegungssensoren sollen dazu verwendet werden eine Person beim Durchgehen eines Türdurchganges zu beobachten.
Neben dem Bewegungssensor beinhaltet der Fibaro Multisensor ein Thermometer ein Lichtsensor sowie einen Erschütterungssensor.
Der Erschütterungssensor wird standardmäßig als Diebstahlschutz verwendet um zusätzliche Ereignisse auszulösen.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.4]{img/Sensorevaluation/FibaroMultiRange.png}
	\caption{Reichweite des Bewegungssensors}
	\label{fig:sensorenFibaroMultiRange}
\end{figure}
 
\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.4]{img/Sensorevaluation/FibaroMultiExamples.png}
	\caption{Generelle Installationspunkte zum Beobachtung eines Raumes}
	\label{fig:sensorenFibaroMultiExamples}
\end{figure}

\subsubsection{Praxistest – Türdurchgang}
Für die Konfiguration der Geräte müssen folgende Anpassungen vorgenommen werden.

Parameter 1 = 8, Parameter 2 = 0, Parameter 6 = 1s

Das hat dann zur Folge das jede Sekunde ein Event geworfen wird. Mit diesen Parametern wird zudem jede kleinste Bewegung eines Menschen, die für eine solche Funktion notwendig ist, erkannt. Nun werden pro Raum ein Sensor vor die Tür mit Sicht zur Tür befestigt. Diese werden dann später von einem Modul der diesen Raumdurchgang implementiert benutzt.

\subsubsection{Parameterübersicht}
\begin{description}
	\item [Parameter 1] Wird benutzt um die Sensitivität des Sensors einzustellen und ist ein Wert zwischen 8 und 255 wobei ein kleinerer Wert eine höhere Sensitivität zur Folge hat.

	\item [Parameter 2] Gibt einen Wert an um den Bewegungssensor eine gewisse Zeit nach einem Erkennen von Bewegung blind zu machen. Dabei ist der Wertebereich hier zwischen 0 und 15 wobei eine Einheit eine halbe Sekunde entspricht. So entspricht ein Wert von 0 0,5 Sekunden während ein Wert von 15 8 Sekunden entspricht.
	\item [Parameter 6] Nach wie vielen Sekunden wird im Hauptcontroller (bei uns Z-Way) der Bewegungssensor nach einem Auslösen des Sensors wieder auf inaktiv gesetzt. Der Countdown wird erneut zurückgesetzt sofern eine neue Bewegung erkannt wird. Um dies entgegenzuwirken soll Parameter 2 weiter angepasst werden.
\end{description}

Mit diesen eingestellten Parametern kann nun bei einem Türdurchgang mit zwei solcher Bewegungssensoren eine Person zuverlässig erkannt werden. Ein Personenzähler hält dabei die erkannten Werte dauerhaft. 

\begin{description}
	\item [Parameter 8] Gibt nur an zu welcher Tageszeit der Sensor aktiv sein soll. Bei dem Wert 0 ist er den ganzen Tag aktiv, bei dem Wert 1 nur am Tag und bei einem Wert von 2 nur bei Nacht. Hinzuzufügen ist hier das die Bestimmung ob Tag oder Nacht ist durch den internen Lichtsensor realisiert wird. Dieser Wert kann unter dem Parameter 9 eingestellt werden.
	\item [Parameter 20] Die Sensitivität des Erschütterungssensor (Wertebereich 0 – 122 = 0.08 – 2g = Wert * 0.016g)
	\item [Parameter 22] Alle wie viele Sekunden wird der Sensor zurückgesetzt und ein neuer Erschütterungswert kann gesendet werden.
	\item [Parameter 26] Der Alarm kann hiermit über einen Broadcast an alle Geräte in der Reichweite gesendet werden, sofern diese einen solchen Broadcast empfangen können.
	\item [Parameter 40] Die minimale Änderung des einfallenden Lichts in Lux um den aktuellen Lux Wert zu senden
	\item [Parameter 42] alle wie viele Sekunden soll der Lux Wert gesendet werden, unabhängig von der Änderung des einfallenden Lichts
	\item [Parameter 60] Die minimale Änderungen der Temperatur bis der aktuelle Wert gesendet wird
	\item [Parameter 62] Alle wie viele Sekunden wird die Temperatur gemessen
	\item [Parameter 64] alle wie viele Sekunden soll der Temperatur Wert gesendet werden, unabhängig von der Änderung der Temperatur
	\item [Parameter 66] Anpassung der erkannten Temperatur zur Kalibrierung des Geräts
	\item [Parameter 80+] Alle Einstellungen für die LED des Auges
\end{description}

\subsubsection{Weitere Funktionalitäten}
Mit dem Parameter 24 = 4 und einer eingestellten minimalen Vibration in Parameter 20 sowie einem Intervall in Parameter 22 in Sekunden ein Seismograph eingestellt werden.

Dabei wird ab dem Erreichen des Minimalwertes intervallmäßig der erkannte Erschütterungswert gesendet solang die Erschütterung über dem Minimalwert anhält.
%TODO Quellen ergänzen
%Weitere Einstellungen, sowie alle konkreten Wertebereiche sind in der Anleitung Motion-Sensor_EN_5.3.14.pdf zu finden.

%http://www.fibarouk.co.uk/counting-people-using-two-motion-sensors/
%http://www.fibaro.com/manuals/en/Motion-Sensor/Motion-Sensor_EN_5.3.14.pdf
%http://www.fibaro.com/de/the-fibaro-system/motion-sensor
%http://www.fibaro.com/sites/all/themes/fibaro/images/motion-sensor/en/motion_sensor_02.png


\subsection{Fibaro Wall Plug (FGWPx-102) – Zwischenstecker}

\emph{(von Patrick Hecker)}
\subsubsection{Funktionalität}
\begin{itemize}
	\item ZWave kompatibler Zwischenstecker in Form eines Steckdosenadapters
	\item Steuerung elektrischer Geräte (max. 2,5 kW)
	\item Messung von Wirkleistung und Stromverbrauch
	\item Anzeige über Schaltzustand und Stromverbrauch über Mehrfarben-LED-Ring
	\item Steuerung am Gerät über Taste
\end{itemize}
\subsubsection{Z-Way Elemente}
\begin{itemize}
	\item Fibaro Wall Plug
	\begin{itemize}
		\item Binary Switch
		\item Steuerung des Schaltzustandes
	\end{itemize}
	\item Meter Electric
	\begin{itemize}
		\item Sensor Multilevel
		\item Stromverbrauch in kW
	\end{itemize}
	\item Sensor Power
	\begin{itemize}
		\item Sensor Multilevel
		\item Wirkleistung in W
	\end{itemize}
\end{itemize}

\subsubsection{Konfiguration}

\paragraph{Immer An - Funktion}
\begin{itemize}
	\item Parameter 1:
	\begin{description}
		\item [0] aktiviert,
		\item [1] deaktiviert
	\end{description}
\end{itemize}

\paragraph{Der Zwischenstecker kann auf Z-Wave Netzwerk Alarm reagieren}
\begin{description}
	\item [Parameter 34:] Welcher Alarm soll Reaktion auslösen?
	\begin{description}
		\item [1] genereller Alarm
		\item [2] Rauchalarm
		\item [4] CO Alarm
		\item [8] CO$_2$ Alarm
		\item [16] Temperaturalarm
		\item [32] Überflutungsalarm
		\item [63] auf jeden Alarm reagieren
	\end{description}
	\item [Parameter 35:] Reaktion auf Alarm
	\begin{description}
		\item [0] keine Reaktion,
		\item [1] Schaltzustand ein,
		\item [2] Schaltzustand aus, zyklischer Wechsel (an/aus) jede Sekunde	
	\end{description}
	\item [Parameter 39:] Dauer der Reaktion
	\begin{itemize}
		\item 1 – 65536 Sekunden
	\end{itemize}
\end{description}

\paragraph{Aussenden verschiedener Reports}
\begin{description}
	\item [Parameter 40 - 45] nur bei Änderung des Stromverbrauchs
	\item [Parameter 47] periodisch, ohne Berücksichtigung des Stromverbrauchs
	\begin{description}
		\item [Parameter 40:] Sofortiger Report über Stromverbrauch (W)
		\begin{itemize}
			\item 1 – 100 \%
		\end{itemize}
		\item [Parameter 42:] Standardmäßiges Aussenden von Reports über den Stromverbrauch
		\begin{itemize}
			\item 1 – 100 \%
		\end{itemize}
		\item [Parameter 43:] Zeitintervall zum Senden eines Reports über den Stromverbrauch
		\begin{itemize}
			\item 1 – 254 Sekunden (bezieht sich auf Parameter 42)
		\end{itemize}
		\item [Parameter 45:] Änderung in der Stromaufnahme durch gesteuerte Geräte (kWh)
		\begin{itemize}
			\item 1 – 254 (0,01 – 2,54 kWh)
		\end{itemize}
		\item [Parameter 47:] Zeitintervall zwischen den Reports über die momentane Wirkleistung und den Stromverbrauch
		\begin{itemize}
			\item 1 – 65534 Sekunden
			\item Erklärung: Report im Zeitintervall, ohne Änderung im Verbrauch!
		\end{itemize}
		\item [Parameter 49:] Messen des Eigenstromverbrauchs des Wall Plug Moduls
		\begin{description}
			\item [0] keine Einbeziehung des Eigenstromverbrauchs
			\item [1] inklusive Eigenstromverbrauch
		\end{description}
	\end{description}
\end{description}

\paragraph{Einstellungen zu Assoziationsgruppe 2}
\begin{description}
	\item [Parameter 50:] Unterer Leistungsschwellwert
	\item [Parameter 51:] Oberer Leistungsschwellwert
	\item [Parameter 52:] Konfiguration des Verhaltens beim Überschreiten der festgelegten Leistungsschwellwerte
\end{description}

\paragraph{Farbeinstellungen}
\begin{description}
	\item[Parameter 60:] Leistungsschwellwert für violettes Blinken
	\begin{itemize}
		\item 1000 – 32000 (100 – 3200 W)
	\end{itemize}
	\item [Parameter 61:] LED-Ring-Farbe im Einschaltzustand
	\item [Parameter 62:] LED-Ring-Farbe im Ausschaltzustand
	\item [Parameter 63:] LED-Ring-Farbe bei Z-Wave-Alarmmeldung
	\item [Parameter 61 - 63:] Farbwerte
	\begin{description}
		\item [1] White
		\item [2] Red
		\item [3] Green
		\item [4] Blue
		\item [5] Yellow
		\item [6] Cyan
		\item [7] Magenta
		\item [8] Farbe aus
	\end{description}
\end{description}
Weitere Informationen (auch technische Details) sind dem Handbuch zu entnehmen.


\subsection{Aoetec Multisensor Sensor}
\emph{(von Alexander Keller)}

\subsubsection{Allgemein}

Im Bereich Smarthome hat man eine riesige Auswahl von verschiedenen Sensoren. Je nach Bedarf bieten die Multisensoren verschiedene Funktionalitäten welche Bewegungen, Raumtemperatur, Licht oder andere registrieren können. Der Aeotec Sensor erfasst 6 verschiedene Messwerte. Die Sensoren messen Raumtemperatur, Lichtstärke, Luftfeuchtigkeit, Bewegung, UV-Sensor und Vibration. Diese Werte überträgt der Multisensor mit einer drahtlosen Kommunikationsschnittstelle names Z-Wave.

In unserem Projekt kommt dieser Sensor zum Einsatz, um das Alarm Modul, Personenidentifikationsmodul und Gefahrenmodul mithilfe seiner Sensortechnik zu unterstützen.


\subsubsection{Konfigurationsmöglichkeiten}

Nachdem man das Gerät erfolgreich im Z-Way Home Center hinzugefügt hat, besteht die Möglichkeit den Multisensor über die Expert-UI zu konfigurieren.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Sensorevaluation/AeoScreenshot.png}
	\caption{Übersichtsseite des Aeotec Multisensor}
	\label{fig:sensorenAeoScreenshot}
\end{figure}

Der Z-Way Server erstellt automatisiert eine Übersichtsseite nachdem der Sensor erfolgreich hinzugefügt wurde. In diesem Reiter besteht die Möglichkeit das Gerät umzubenennen, Netzwerkstatus abzurufen, \gls{sdk} Version.

Im Reiter „Configuration“ findet man alle Einstellungsmöglichkeiten die der Sensor bietet. In der nachfolgenden Tabelle, finden sie alle Konfigurationsoptionen.
\begin{longtabu} to \linewidth {
		>{}X
		>{}X
		>{}X
	}
	
	% ----------- headings -----------
	\hline
	\textbf{Name}							& \textbf{Optionen}		& \textbf{Beschreibung} \\
	\hline
	\endfirsthead
	\hline
	\textbf{Name}							& \textbf{Optionen}		& \textbf{Beschreibung} \\
	\hline
	\endhead
	\hline 
	% ----------- end headings -----------
	% ----------- begin footer -----------
	\multicolumn{3}{r}{{Fortsetzung auf nächster Seite}}  \\ 
	%\hline
	\endfoot
	%\hline
	\endlastfoot
	% ----------- end footer -----------
	Wake Up 10 Minutes when	batteries are inserted	
			& No \newline Yes				
					& Der Sensor "`erwacht"' alle 10 Minuten, wenn Batterien eingelegt sind. \\ 

	\hline 
	On Time									& X Minuten	 		& Wie lang sollen die verschiedenen Sensoren den aktuellen Wert speichern bevor diese aktualisiert werden \\ 
	\hline
	Enable/Disable the function of motion Sensor &
			(0) disable \newline
			(1) enable, the current PIR sensitivity level=1. (minimum level) \newline
			(2) enable, the current PIR sensitivity level = 2. \newline
			(3) enable, the current PIR sensitivity level=3. \newline
			(4) enable, the current PIR sensitivity level=4. \newline
			(5) \uline{enable, the current PIR sensitivity level=5. (maximum level)} \newline &
					Es besteht die Möglichkeit den Bewegungssensor zu deaktivieren \& die Intensität einzustellen \\
	\hline
	Motion Detection &
			(1) \uline{Send Basic Set CC.} \newline
			(2) Send Sensor Binary Report CC. &
					Welchen Standard soll der Aeotec Sensor sende, wenn der Bewegungssensor ausgelöst wurde \\
	\hline
	Low Batterie Value &
			X \% &
					Ab welchen prozentualen Wert soll der Sensor bescheid geben, wenn der Batteriestand niedrig ist. \\
	\hline
	Reports for Parameter 41 – 44 &
			(0) \uline{disable} \newline
			(1) enable &
					Diese Funktionalität dient dazu um bestimmte Schwellenwerte in bestimmten Zeitabständen zu an den Z-Way Server zu senden. (Netzwerktraffic) \\
	\hline
	Humidity Automatic Report &
			X Schwellenwert &
					Festlegen eines Schwellenwertes für den Feuchtigkeitssensor \\
	\hline
	Luminance Automatic Report &
			X Luminanz &
					Festlegen eines Schwellenwertes für den Lichtsensor \\
	\hline
	Battery Automatic Report &
			X Prozent &
					Festlegen eines Schwellenwertes für die Batterieänderung \\
	\hline
	Threshold change in ultraviolet to induce an automatic report. &
			X Schwellenwert &
					Festlegen eines Schwellenwertes für Ultra Violettes Licht \\
	\hline
	Low Temperature Alarm Report &
			(0) Disable to send the alarm report of low temperature \newline
			(1) Enable to send the alarm report of low temperature &
				 Bericht wenn die Temperatur unter 15 Grad fällt. \\
	\hline
	Unsolicitate reports interval for timing groups 1 / 2 / 3 &
			X Sekunden &
					Alle X Sekunden sendet der Motion Sensor einen Bericht. \\
	\hline
	Lock Configuration &
			(0) Disable all configuration parameters to be locked.\newline
			(1) Enable all configuration parameters to be locked. &
					Alle Änderungen von Parametern werden gespeichert. \\
	\hline
	Reset to default factory setting &
			(1) Resets all configuration parameters to default setting. \newline
			(1431655765) Reset the product to default factory setting and be excluded from the Z-wave network. &
					Hier besteht die Möglichkeit den Mutlisensor komplett auf Werkseinstellung zurückzusetzen \& ihn anschließend aus dem Z-Way Netzwerk zu entfernen. \\
	\hline
	WakeUp Settings &
			X Sekunden &
					Nach wie vielen Sekunden der Sensor erwachen sollen, wenn keine Aktivität vorhanden war \\
	\hline
		
\caption{Config des Sensors} \\
\end{longtabu}

\subsubsection{Praxistest}
Um das Gerät ausführlich testen zu können, ist es notwendig als ersten Schritt die Batterien einzulegen. Der Motion Sensor von Aeotec benötigt 4x AAA Batterien, welche mindestens 12 Monate lange halten.
\subsubsection{Motion Sensor}
Die effektive Reichweite des Bewegungssensors ist begrenzt. Anhang der Skizze ist zu erkenne, dass der Radius bei einer Höhe von 3 Metern, maximal 10 Meter beträgt.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Sensorevaluation/AeoMeter1.png}
	\caption{Bewegungssensor in der Praxis ohne Hindernisse}
	\label{fig:sensorenAeoMeter1}
\end{figure}

Falls eine Wand oder andere Hindernisse im Weg sind muss die Berechnung des Durchmesser, sowie die Reichweite des Bewegungssensors individuell angepasst werden. Im folgenden Beispiel hängt der Sensor von Aeotec nicht an der Decke, sondern ist an einer Wand befestigt.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Sensorevaluation/AeoMeter2.png}
	\caption{Bewegungssensor in der Praxis an einer Wand}
	\label{fig:sensorenAeoMeter2}
\end{figure}

\subsubsection{Temperatur}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{img/Sensorevaluation/AeoTemp.png}
	\caption{Aoetec Temperatursensor}
	\label{fig:sensorenAeoTemp}
\end{figure}

Der Multisensor der Firma Aeotec bietet die Möglichkeit dem Nutzer die aktuelle Raumtemperatur anzuzeigen. Im Praxistest hat sich gezeigt, dass die Temperatur immer 1 – 3 Grad Celsius zu viel angezeigt hat. Eine Kalibrierung des Sensors ist laut Konfigurationsmöglichkeiten (siehe oben) nicht möglich. Das wiederum heißt, dass der Nutzer seinen Schwellenwert immer um den Mittelwert 2 Grad Celsius anheben sollte.

\subsubsection{Lichtsensor}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{img/Sensorevaluation/AeoLight.png}
	\caption{Aoetec Lichtsensor}
	\label{fig:sensorenAeoLight}
\end{figure}

In der Praxis erwies sich sich der Lichtsensor für sehr zuverlässig. Der Anwendungsbereich dafür wäre eine automatisierte Rollladensteuerung oder Lampensteuerung.

\subsubsection{Luftfeuchtigkeitssensor}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{img/Sensorevaluation/AeoHum.png}
	\caption{Aoetec Feuchtigkeitssensor}
	\label{fig:sensorenAeoHum}
\end{figure}

Der Aoetec Sensor besitzt einen Luftfeuchtigkeitssensor mit diesem man die Luftfeuchtigkeit zwischen 0\% und 100\% messen kann. Die praktische Anwendung wäre eine automatisierte Tür- \& Fenstersteuerung, welches ein perfektes Klima im Raum ermöglicht.

\subsubsection{Vibrationssensor}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{img/Sensorevaluation/AeoVib.png}
	\caption{Aoetec Vibrationssensor}
	\label{fig:sensorenAeoVib}
\end{figure}

Durch den eingebauten seismischen Sensor überwacht dieser Erschütterungen und Vibrationen. Diese Funktionalität bietet sich bestens um Alarm diesen Vibrationssensor in ein Alarmmodul zu integrieren damit dieser bei ungewöhnlichen Erschütterungen Alarm schlägt.

\subsubsection{UV Sensor}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{img/Sensorevaluation/AeoUV.png}
	\caption{Aoetec UV-Sensor}
	\label{fig:sensorenAeoUV}
\end{figure}

Ab einen bestimmten Anteil von ultravioletten Licht ist dieses sehr schädlich für das Auge. Um sich davor zu schützen, sind elektrische Jalousien oder Rollläden notwendig.



\subsection{Philio 4-in-1 Multisensor}
\emph{(von Tobias Weise)}
\subsubsection{Allgemein}
Im Bereich Smart Home hat man eine riesige Auswahl von verschiedenen Sensoren. Je nach Bedarf biete der Philio 4-in-1 Multisensor verschiedene Funktionalitäten, welche Bewegungen, Tür- und Fenster öffnen bzw. schließen, Licht- oder Temperaturänderungen registrieren können. Der Philio 4-in-1 Multisensor ist somit in der Lage 4 verschiedene Messwerte zu erfassen. Diese Werte überträgt der Multisensor mit einer drahtlosen Kommunikationsschnittstelle names Z-Wave an den Z-Way Server.

Im Rahmen des Projektes kommt dieser Sensor zum Einsatz, um das Öffnen und Schließen der Wohnungstüre, sowie Bewegungen innerhalb des Raumes zu registrieren. Dabei findet er hauptsächlich in den Modulen „LockDoorModule“, „PersonCounterModule“ und „StandbyModule“ Verwendung. Durch die vielseitigen Einstellungsmöglichkeiten der Parameter des Sensors, wird nachfolgend eine Evaluierung der Möglichkeiten, die man bei der Parametereinstellung hat, durchgeführt.

\subsubsection{Konfigurationsmöglichkeiten}
Nachdem man den Sensor erfolgreich in das Z-Way Home Center eingefügt hat, besteht die Möglichkeit, den Multisensor über die Expert-UI zu konfigurieren.


\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Sensorevaluation/PhilioConf1.png}
	\caption{Übersichtsseite des Philio 4-in-1 Multisensors}
	\label{fig:sensorenPhilioConf1}
\end{figure}

Der Z-Way Server erstellt automatisiert eine Übersichtsseite, nachdem der Sensor erfolgreich hinzugefügt wurde. In diesem Reiter besteht die Möglichkeit, das Gerät umzubenennen, den Netzwerkstatus abzurufen und die aktuelle Sensor-Version abzufragen. Im Reiter „Configuration“ findet man alle Einstellungsmöglichkeiten die der Sensor bietet. In der nachfolgenden Tabelle (\prettyref{tab:PhilioConf}) sind die wichtigsten Konfigurationsoptionen aufgelistet.


\begin{longtabu} to \linewidth {
		>{\hsize=0.1\hsize}X
		>{\hsize=0.9\hsize}X
		>{\hsize=1.5\hsize}X 
		>{\hsize=1.5\hsize}X
		% sum=4.0\hsize for 4 columns
	}
	\hline
	\textbf{Nr}
			& \textbf{Name}
					& \textbf{Beschreibung}
							& \textbf{Werte} \\
	\hline
	2	
			& Grundeinstellung 
					& Setzt den Standardwert, um das Licht einzuschalten
							& -1 \textrightarrow{ }einschalten \newline 1 – 99 \textrightarrow{ }Dimmerintensität \\
	\hline
	3	
			& Sensitivität Bewegungsmelder 
					& Festlegen der Bewegungserkennungsintensität
							& 0 \textrightarrow{ }keine Bewegungserkennung \newline
							1 – 99 \textrightarrow{ }1 ist niedrigste Sensitivität, 99 die höchste \\
	\hline
	4	
			& Lichtschwellwert 
					& Festlegen des Beleuchtungsschwellwertes, um das Licht einzuschalten. Wenn das Event auslöst und die Umgebung dunkler ist, als der Schwellwert, geht das Licht an 
							& 1 – 99 \textrightarrow{ }1 ist dunkel, 99 ist hellster Wert \newline
							100 \textrightarrow{ }Lichterkennung deaktiviert \newline
							0 \textrightarrow{ }Lichterkennung deaktiviert und das Licht wird nie angeschaltet \\
	\hline
	5	
			& Betriebsmodus 
					& Bit 0 und Bit 1 werden freigeschaltet, sobald der PID-Schalter auf Programmmodus umgeschaltet wurde
					%todo wirklich PID?
							& (Bit) 0 \textrightarrow{ }Sicherheitsmodus \newline
							(Bit) 1 \textrightarrow{ }Testmodus \newline
							(Bit) 2 \textrightarrow{ }Fenster-/Türsensor deaktiviert \newline
							(Bit) 3 \textrightarrow{ }0 für Fahrenheit, 1 für Celsius \newline
							(Bit) 4 \textrightarrow{ }deaktiviere Lichtwertübergabe bei Auslösen des Events \newline
							(Bit) 5 \textrightarrow{ }deaktiviere Temperaturwertübergabe bei Auslösen des Events
							 \\
	\hline
	6	
			& Multisensor Funktionsschalter
					& Setzt den Standardwert, um das Licht einzuschalten \newline
							& (Bit) 0 \textrightarrow{ }deaktiviere integrierte Beleuchtung \newline
							(Bit) 1 \textrightarrow{ }deaktiviere integrierte Bewegungsmelder-Beleuchtung \newline
							(Bit) 2 \textrightarrow{ }deaktiviere Bewegungsmelder \newline
							(Bit) 3 \textrightarrow{ }wenn Bit 2 0 ist (aktiviert), ist das Gerät dann im selben Raum installiert? 0 = gleicher Raum (Standard), 1 = anderer Raum \newline
							(Bit) 4 \textrightarrow{ }deaktiviere die Verzögerung von 5 Sekunden beim Licht ausschalten, wenn Tür/Fenster geschlossen wurden \newline
							(Bit) 5 \textrightarrow{ }deaktiviere automatisches Licht ausschalten, nachdem Fenster/Tür geöffnet wurden und das Licht anging (keine Verwendung, wenn Bit 2 = 0) \newline
							(Bit) 6 \textrightarrow{ }Aktivere Temperaturaufzeichnung. Temperaturreport alle 64 Sekunden, wenn Veränderung von 3 Grad Fahrenheit und Überschreitung von 140 Grad Fahrenheit \\
	\hline
	8	
			& Bewegungsmelder, erneute Entdeckungszeit
					& Setzen der nächsten Entdeckungszeit, wenn ein Objekt entdeckt wurde und sich das Gerät im Sicherheitsmodus befindet
							& 3 – 127 \textrightarrow{ }Eingegebener Wert mal 8 Sekunden entspricht dem Zeitwert. \newline
							Minimale Zeit beträgt 24 Sekunden. \\
	\hline
	9	
			& Abschaltlichtzeit
					& Setzen der Verzögerungszeit um das Licht wieder auszuschalten, wenn der Bewegungsmelder nicht ausgelöst hat und nachdem das Licht angeschaltet wurde
							& 4 – 127 \textrightarrow{ }Eingegebener Wert mal 8 Sekunden entspricht dem Zeitwert. \newline Minimale Zeit beträgt 32 Sekunden. \\
	\hline
	10	
			& Auto- Reportzeit der Batterielebensdauer
					& Intervallzeit für automatische Meldung über die Batterierestkapazität
							& 1 – 127 \textrightarrow{ }Eingegebener Wert mal 30 Minuten entspricht dem Zeitwert. \newline Minimale Zeit beträgt 30 Minuten. \\
	\hline
	11	
			& Auto-Reportzeit  des Fenster/Tür Status
					& Intervallzeit für automatische Meldung des Fenster/Tür Status
							& 1 – 127 \textrightarrow{ }Eingegebener Wert mal 30 Minuten entspricht dem Zeitwert. \newline Minimale Zeit beträgt 30 Minuten. \\
	\hline
	12	
			& Auto-Reportzeit der Beleuchtung
					& Intervallzeit für automatische Meldung des Beleuchtungsstatus
							& 1 – 127 \textrightarrow{ }Eingegebener Wert mal 30 Minuten entspricht dem Zeitwert. \newline Minimale Zeit beträgt 30 Minuten. \\
	\hline
	13	
			& Auto-Reportzeit der Temperatur
					& Intervallzeit für automatische Meldung der Temperatur
							& 1 – 127 \textrightarrow{ }Eingegebener Wert mal 30 Minuten entspricht dem Zeitwert. \newline Minimale Zeit beträgt 30 Minuten. \\
	\hline
\caption{Konfiguration des Philio Multisensor}
\label{tab:PhilioConf}
\end{longtabu}

\subsubsection{Praxistest}
Um das Gerät in das Netzwerk einbinden zu können, ist es für die erste Konfiguration nur notwendig, den Stromkreislauf mit der Batterie zu verbinden und schon verbindet sich das Gerät innerhalb von 5 Sekunden automatisch mit dem Z-Wave-Netzwerk, wenn sich der Controller im "`Inclusion Mode"' befindet. Wenn man zu einem späteren Zeitpunkt eine Integration in das Netzwerk wünscht, genügt es, den Manipulationsschutzschalters auf der Rückseite drei Mal zu drücken. Ein einmaliges Drücken des erwähnten Schalters, hat eine Wake-up-Funktion zur Folge.

In manchen Fällen besteht nach Recherche allerdings die Möglichkeit, dass nach dem Inkludieren keine Funktion angezeigt wird. Um dem Abhilfe zu schaffen, wurde die nachfolgende Anleitung erstellt.

Z-Wave verfügt über die Möglichkeit, Geräte als "`secure"' in das Z-Wave-Netzwerk zu inkludieren. Dabei erfolgt die Kommunikation zwischen dem Sensor und dem Gateway verschlüsselt. Allerdings ist es in diesem Falle möglich, dass der Philio-Multisensor keine Zustandsänderungen an das Gateway sendet. In diesem Falle muss man die Experten-Oberfläche des Z-Way-Servers öffnen (\prettyref{fig:sensorenPhilioConf2}).

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Sensorevaluation/PhilioConf2.png}
	\caption{Oberfläche des Z-Way-Servers}
	\label{fig:sensorenPhilioConf2}
\end{figure}

Auf der Experten-Oberfläche wählt man anschließend den Menüpunkt \textbf{Network} und darunter den Menüpunkt \textbf{Control} (\prettyref{fig:sensorenPhilioConf3}).

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Sensorevaluation/PhilioConf3.png}
	\caption{Experten-Oberfläche}
	\label{fig:sensorenPhilioConf3}
\end{figure}

An dieser Stelle hat man die Möglichkeit, den Inkludiermodus von „secure“ zu „unsecure“ zu ändern (1.). Anschließend muss man den „Start Inclusion“-Button drücken (2.), um das Inkludieren zu beginnen (\prettyref{fig:PhilioConf4}). 

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{img/Sensorevaluation/PhilioConf3.png}
	\caption{Auswahl des Inkludiermodus}
	\label{fig:sensorenPhilioConf4}
\end{figure}

Wenn man nun die kleine Schalter-Lasche des Sensors 3x hintereinander (innerhalb von 1,5 Sekunden) betätigt, sollte der Multisensor erfolgreich in das Z-Way-Netzwerk integriert worden sein. Auf der Smart Home Benutzeroberfläche werden die Elemente automatisch generiert, welche die Funktionen des Philio-Multisensors darstellen.

%TODO Quellen
%Webquellen
%[Pep 1]		Z-Wave Device Library
%http://www.pepper1.net/zwavedb/device/585
%[Zwa 1]		Z-Wave Erfahrungsbericht
%http://www.zwave-review.com/tests/Phlio_mutisensor.php
%[Zwa 2]		Problembehebung mit Philip Mehrfachsensor
%http://www.zwave.de/problembehebung-mit-philio-mehrfachsensor/
